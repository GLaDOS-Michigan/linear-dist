Two Phase Commit, but not allowing nodes to have receive and send in one atomic step